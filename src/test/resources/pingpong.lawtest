test_message = "test_message"
ping_message = "ping"
pong_message = "pong"

foo = new Agent "foo"
bar = new Agent "bar"

test0 = new Test "Messages other than ping or pong can't be sent", ->
    foo.send bar, test_message
    assert not bar.message_from(foo)?

test1 = new Test "Can't pong without ping", ->
    foo.send bar, pong_message
    assert not bar.message_from(foo)?

test2 = new Test "Ping", ->
    foo.send bar, ping_message
    assert bar.message_from(foo) is ping_message

test3 = new Test "Can't ping again before pong", ->
    after test2
    foo.send bar, ping_message
    assert not bar.message_from(foo)?

test4 = new Test "Pong", ->
    after test3
    foo.send bar, pong_message
    assert bar.message_from(foo) is pong_message

test5 = new Test "Can ping again after pong", ->
    after test4
    foo.send bar, ping_message
    assert not bar.message_from(foo)?
