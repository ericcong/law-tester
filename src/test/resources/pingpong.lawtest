test_message = "test_message"
ping_message = "ping"
pong_message = "pong"

foo = AGENT "foo"
bar = AGENT "bar"

test1 = TEST "Messages other than ping or pong can't be sent",
    let: -> foo.send bar, test_message
    assert: -> bar.receives null, from: foo

test2 = TEST "Can't pong without ping",
    let: -> foo.send bar, pong_message
    assert: -> bar.receives null, from: foo

test3 = TEST "Ping",
    let: -> foo.send bar, ping_message
    assert: -> bar.receives ping_message, from: foo

test4 = TEST "Can't ping again before pong",
    after: test3
    let: -> foo.send bar, ping_message
    assert: -> bar.receives null, from: foo

test5 = TEST "Pong",
    after: test4
    let: -> foo.send bar, pong_message
    assert: -> bar.receives pong_message, from: foo

test6 = TEST "Can ping again after pong",
    after: test5
    let: -> foo.send bar, ping_message
    assert: -> bar.receives null, from: foo
